---
title: React Server Components
description: Install Kilpi for React Server Components
sidebar:
  label: React (RSC)
---

import { Tabs, TabItem } from "@astrojs/starlight/components";
import { Steps } from "@astrojs/starlight/components";

Ensure you have setup Kilpi using the [quickstart guide](/getting-started/quickstart) before proceeding.

<Steps>

1.  ### Install React RSC Plugin

    To get started with Kilpi for Next, install the **[React RSC Plugin](/plugins/react-server-components)**.

    <Tabs syncKey="package-manager">
      <TabItem label="npm">
        ```bash
        npm install @kilpi/react-server
        ```
      </TabItem>

      <TabItem label="yarn">
        ```bash
        yarn add @kilpi/react-server
        ```
      </TabItem>

      <TabItem label="pnpm">
        ```bash
        pnpm add @kilpi/react-server
        ```
      </TabItem>

      
      <TabItem label="bun">
        ```bash
        bun add @kilpi/react-server
        ```
      </TabItem>
    </Tabs>

    Apply the plugin in your Kilpi configuration as follows.

    ```diff lang="ts"
    // kilpi.ts
    export const Kilpi = createKilpi({
      getSubject,
      policies,
    + plugins: [ReactServerComponentPlugin()]
    })
    ```

    This allows you to **use Kilpi in RSCs** without having to define an explicit scope.

    ```tsx {2,3}
    export default async function ProtectedPage() {
      Kilpi.onUnauthorized(() => redirect("/"));
      Kilpi.authorize("any:policy");
      return <div>...</div>
    }

2.  ### Create Kilpi components

    For easier use of Kilpi in your Next app, create the `<Access />` Kilpi component.

    ```diff lang="ts"
    // kilpi.ts
    export const Kilpi = createKilpi({ ... });

    // Optionally pass default Loading and Unauthorized
    // components as the second argument
    + export const { Access } = createKilpiReactServerComponents(Kilpi);
    ```

    You can use it in your RSCs like so:

    ```tsx
    import { Access } from "../kilpi";

    export default async function Page() {
      return <Access
        to="my:policy"
        on={someResource}
        Unauthorized={<p>Unauthorized</p>} // Optional
        Loading={<p>Loading...</p>} // Optional  
      >
        {/* Rendered if access granted */}
        <div>...</div>
      </Access>
    }
</Steps>