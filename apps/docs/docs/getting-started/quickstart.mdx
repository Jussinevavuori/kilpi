---
title: Quickstart
sidebar:
  order: 2
---

Follow this guide to protect your first functionality in 5 minutes.

---

<Steps>

  <Step>
  ### Install Kilpi

Install the Kilpi core library.

  <Tabs syncKey="package-manager">
    <Tab label="npm">
      ```bash
      npm install @kilpi/core
      ```
    </Tab>

    <Tab label="yarn">
      ```bash
      yarn add @kilpi/core
      ```
    </Tab>

    <Tab label="pnpm">
      ```bash
      pnpm add @kilpi/core
      ```
    </Tab>


    <Tab label="bun">
      ```bash
      bun add @kilpi/core
      ```
    </Tab>

  </Tabs>

  </Step>

  <Step>
    ### Instantiate Kilpi

    Copy and paste the code below and replace the `getSubject` implementation to fetch the current subject (â‰ˆ user) from your authentication provider.

    ```ts
    // src/kilpi.ts
    import { createKilpi, Grant, Deny } from "@kilpi/core";

    export const Kilpi = createKilpi({
      // (1) Your subject adapter with optional `ctx` param.
      async getSubject(ctx: MyContextType) {
        return myAuthenticationProvider.getCurrentUser(ctx);
      },

      // (2) Your policies
      policies: {
        posts: {
          // "All authenticated users can create posts"
          async create(subject) {
            if (!subject) return Deny()
            return Grant(subject);
          },
          // "Only author can delete own post"
          async delete(subject, post: { authorId: string }) {
            if (!subject) return Deny();
            if (subject.userId !== post.authorId) return Deny();
            return Grant(subject);
          },
        },
      },
    });
    ```

    Read more about the [subject](/docs/concepts/subject) and [policies](/docs/concepts/policy).

  </Step>

  <Step>
    ### Authorize your first function

    Reference a policy e.g. `Kilpi.posts.delete(myPost)` and receive an authorization decision using `.authorize()`. If your `getSubject` adapter takes in a `ctx` parameter, pass it as shown below.

    ```ts
    import { Kilpi } from "...";

    const { granted } = await Kilpi
      .posts                       // (Policy namespace)
      .delete({ authorId: "123" }) // Reference policy with object
      .authorize({ ctx });         // Run the authorization check

    if (granted) {
      await deletePost(myPost.id);
    }
    ```

  </Step>
</Steps>
